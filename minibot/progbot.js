/*! progbot v1.0.0 (c) sarkiroka */
(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=18)})([function(a,b,c){(function(d){function e(){var a;try{a=b.storage.debug}catch(a){}return!a&&'undefined'!=typeof d&&'env'in d&&(a=d.env.DEBUG),a}b=a.exports=c(22),b.log=function(){return'object'==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},b.formatArgs=function(a){var d=this.useColors;if(a[0]=(d?'%c':'')+this.namespace+(d?' %c':' ')+a[0]+(d?'%c ':' ')+'+'+b.humanize(this.diff),!!d){var e='color: '+this.color;a.splice(1,0,e,'color: inherit');var c=0,f=0;a[0].replace(/%[a-zA-Z%]/g,function(a){'%%'===a||(c++,'%c'===a&&(f=c))}),a.splice(f,0,e)}},b.save=function(a){try{null==a?b.storage.removeItem('debug'):b.storage.debug=a}catch(a){}},b.load=e,b.useColors=function(){return'undefined'!=typeof window&&window.process&&'renderer'===window.process.type||('undefined'!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:'undefined'!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||'undefined'!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||'undefined'!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||'undefined'!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},b.storage='undefined'!=typeof chrome&&'undefined'!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(a){}}(),b.colors=['#0000CC','#0000FF','#0033CC','#0033FF','#0066CC','#0066FF','#0099CC','#0099FF','#00CC00','#00CC33','#00CC66','#00CC99','#00CCCC','#00CCFF','#3300CC','#3300FF','#3333CC','#3333FF','#3366CC','#3366FF','#3399CC','#3399FF','#33CC00','#33CC33','#33CC66','#33CC99','#33CCCC','#33CCFF','#6600CC','#6600FF','#6633CC','#6633FF','#66CC00','#66CC33','#9900CC','#9900FF','#9933CC','#9933FF','#99CC00','#99CC33','#CC0000','#CC0033','#CC0066','#CC0099','#CC00CC','#CC00FF','#CC3300','#CC3333','#CC3366','#CC3399','#CC33CC','#CC33FF','#CC6600','#CC6633','#CC9900','#CC9933','#CCCC00','#CCCC33','#FF0000','#FF0033','#FF0066','#FF0099','#FF00CC','#FF00FF','#FF3300','#FF3333','#FF3366','#FF3399','#FF33CC','#FF33FF','#FF6600','#FF6633','#FF9900','#FF9933','#FFCC00','#FFCC33'],b.formatters.j=function(a){try{return JSON.stringify(a)}catch(a){return'[UnexpectedJSONParseError]: '+a.message}},b.enable(e())}).call(b,c(21))},function(a){var b=function(a,c){b.canvas=a,b.ctx=c};b.canvas=null,b.ctx=null,b.center={},b.centerX=0,b.centerY=0,b.setSize=function(a,c){b.width=a,b.height=c,b.canvas.width=a,b.canvas.height=c,b.centerX=a/2,b.centerY=c/2,b.center={x:b.centerX,y:b.centerY}},a.exports=b},function(a,b,c){var d=c(26),e=c(28),f={IDLE:'IDLE',CHECK_ANIMATION:'CHECK_ANIMATION',RESULT_ANIMATION:'RESULT_ANIMATION',END:'END'},g=[],h=0,i=f.IDLE;a.exports=function(a){if('undefined'!=typeof a&&1<=arguments.length){var b='string'==typeof f[a];b?i=f[a]:console.warn(a,'is not a valid state')}return i},a.exports.IDLE=f.IDLE,a.exports.CHECK_ANIMATION=f.CHECK_ANIMATION,a.exports.RESULT_ANIMATION=f.RESULT_ANIMATION,a.exports.END=f.END,a.exports.addProgramStep=function(a){return i==f.IDLE?(g.push(a),1):(console.warn('the operation is not permitted by current game state'),-1)},a.exports.removeLastProgramStep=function(){return i==f.IDLE?0==g.length?(console.warn('there are no more proram step'),0):(g.pop(),1):(console.warn('the operation is not permitted by current game state'),-1)},a.exports.getProgram=function(){return g};var j=null;a.exports.getBoard=function(){return j},a.exports.levelUp=function(){h++},a.exports.loadBoard=function(a){d(h,function(b,c){b?console.error('error in board request',b):j=c.board,g=[],c.demo?e(c.demo,a):a()})},a.exports.getLevel=function(){return h}},function(a){a.exports={backgroundColor:'#777',programStepBackground:'#999',programStepHighlightBackground:'#ddd',arrowGradientStartColor:'#000',arrowGradientEndColor:'#888',arrowHighlightGradiendStartColor:'#800',arrowHighlightGradiendEndColor:'#d00',waitGradientStartColor:'#080000',waitGradientEndColor:'#928888',waitHighlightGradiendStartColor:'#800',waitHighlightGradiendEndColor:'#d22',waitTextColor:'#aaa',waitTextHighlightColor:'#eee',programStepSize:50,programStepMargin:3,boardItemSize:50,boardItemMargin:3,dummy:null}},function(a,b,c){var d=c(10),e=c(0)('progbot:draw:redraw'),f=c(11),g=c(13),h=c(2);a.exports=function(){e('now redraw'),d(),g(h.getProgram()),f(h.getBoard())}},function(a){a.exports={beforeResultTimeSeconds:0.75,resultTimeSeconds:5,robotStepTimeSeconds:2,waitForNextStepSeconds:0.5}},function(a,b,c){var d=Math.round,e=Math.floor,f=c(1),g=c(3),h=c(12),i=c(2);a.exports=function(a,b){var c=i.getBoard(),d=h(c),j=f.centerX-e(d.x/2)*g.boardItemSize-g.boardItemSize/2,k=f.centerY-e(d.y/2)*g.boardItemSize-g.boardItemSize/2,l=g.boardItemSize-g.boardItemMargin,m=0.5*l;return{x:j+a*g.boardItemSize+m,y:k+b*g.boardItemSize+m}},a.exports.reverse=function(a,b){var c=i.getBoard(),j=h(c),k=f.centerX-e(j.x/2)*g.boardItemSize-g.boardItemSize/2,l=f.centerY-e(j.y/2)*g.boardItemSize-g.boardItemSize/2,m=g.boardItemSize-g.boardItemMargin,n=0.5*m;return{x:d((a-k-n)/g.boardItemSize),y:d((b-l-n)/g.boardItemSize)}}},function(a){a.exports={S:2,E:4,X:1,C:6,"#":0}},function(a,b,c){var d=c(1),e=c(3),f=document.getElementById('robot');a.exports=function(a,b){'number'!=typeof b&&(b=1);var c=d.ctx,g=e.boardItemSize-e.boardItemMargin,h=0.05*g*b,i=0.9*g*b,j=0.5*g*b;c.save(),c.translate(a.x,a.y),c.rotate(a.direction*Math.PI/180),c.drawImage(f,-j+h,-j+h,i,i),c.restore()}},function(a,b,c){var d=c(1),e=c(0)('progbot:draw:board:save'),f=null,g=null;a.exports=function(a){(f||g)&&console.warn('overwrite a saved image data'),f=d.ctx.getImageData(a.x,a.y,a.w,a.h),g={x:a.x,y:a.y}},a.exports.clear=function(){f=null,g=null},a.exports.restore=function(){d.ctx.putImageData(f,g.x,g.y)}},function(a,b,c){var d=c(1),e=c(3),f=c(0)('progbot:draw:clear'),g=c(2);a.exports=function(){f('clear all pixels');var a=d.ctx;a.setTransform(1,0,0,1,0,0),a.save(),a.fillStyle=e.backgroundColor,a.fillRect(0,0,d.canvas.width,d.canvas.height),a.textAlign='right',a.textBaseline='top',a.fillStyle='#fff',a.fillText('#'+g.getLevel(),d.width-5,5),a.restore()}},function(a,b,c){var d=Math.floor,e=c(1),f=c(3),g=c(0)('progbot:draw:board'),h=c(31),j=c(12);a.exports=function(a,b){var c=j(a),k=e.centerX-d(c.x/2)*f.boardItemSize-f.boardItemSize/2,l=e.centerY-d(c.y/2)*f.boardItemSize-f.boardItemSize/2;if(g('draw the board'),e.ctx.fillStyle='#eee',e.ctx.strokeStyle='#000',a)for(var m=0;m<a.length;m++)h(a[m],b);var i={x:k,y:l,w:2*(e.centerX-k),h:2*(e.centerY-l)};return i}},function(a,b,c){var d=c(0)('progbot:draw:board:get-size'),e={x:0,y:0};a.exports=function(a){if(!a||!a.length)d('zero length board found',a),h=e;else{var b=Infinity,c=Infinity,f=-Infinity,g=-Infinity;a.forEach(function(a){a.x<b&&(b=a.x),a.x>f&&(f=a.x),a.y<c&&(c=a.y),a.y>g&&(g=a.y)});var h={x:f-b,y:g-c};d('found a board with size',h)}return h}},function(a,b,c){var d=c(1),e=c(3),f=c(0)('progbot:draw:program-steps'),g=c(32);a.exports=function(a,b){var c=Math.max(1,Math.floor(d.width/e.programStepSize)),h=Math.ceil(a.length/c);f('now draw %d rows and %d cols',h,c);var i=0;d.ctx.lineWidth=1,d.ctx.strokeStyle='#000';for(var j=h-1;-1<j;j--)for(var k=0;k<c&&!(i>a.length-1);k++)g(j,k,a[i],b==i),i++}},function(a,b,c){var d=c(35);a.exports=function(){document.addEventListener('keydown',d)},a.exports.done=function(){document.removeEventListener('keydown',d)}},function(a,b,c){function d(){(!q||r)&&(clearTimeout(p),e())}function e(){n(n.IDLE),l()}var f=c(40),g=c(46),h=c(11),i=c(47),j=c(48),k=c(5),l=c(4),m=c(9),n=c(2),o=c(16),p=-1,q=null,r=!1;a.exports=function(){if(n()==n.RESULT_ANIMATION)d();else if(n()==n.IDLE){n(n.CHECK_ANIMATION),r=!1;var a=h(n.getBoard(),!0);a=j(a),m(a),f(function(a,b){a&&console.error(a),setTimeout(function(){n(n.RESULT_ANIMATION),m.clear(),f.reset(),q=g(b),i(q),q?(n.levelUp(),n.loadBoard(function(){r=!0,p=setTimeout(e,1e3*k.resultTimeSeconds)})):p=setTimeout(e,1e3*k.resultTimeSeconds)},1e3*k.beforeResultTimeSeconds)})}else n()==n.CHECK_ANIMATION?o():console.warn('don\'t touch the keyboard while animating!!',n())},a.exports.cancelResult=d},function(a,b,c){var d=c(5),e=!1,f=12,g=d.robotStepTimeSeconds,h=d.waitForNextStepSeconds,i=d.resultTimeSeconds,j=d.robotStepTimeSeconds/f,k=d.waitForNextStepSeconds/f,l=d.resultTimeSeconds/f;a.exports=function(){e=!e,e?(d.resultTimeSeconds=l,d.robotStepTimeSeconds=j,d.waitForNextStepSeconds=k):(d.resultTimeSeconds=i,d.robotStepTimeSeconds=g,d.waitForNextStepSeconds=h)}},function(a,b,c){var d=c(2);a.exports=function(a){d.addProgramStep(a)}},function(a,b,c){var d=c(19),e=c(52);d(),e()},function(a,b,c){c(20);var d=c(24),e=c(25),f=c(29),g=c(14);a.exports=function(){e(function(){d(),f(),g()})}},function(a,b,c){var d=c(0);d.enable('progbot:*,'+['draw:arrow','draw:wait','draw:draw-step','draw:program-steps','draw:board:get-size','event:on:end-of-programming:animate-step','draw:board','draw:clear','draw:redraw','event:resize','game:board:get-board','init:debug','draw:util:extend-board','event:on:end-of-programming:animate-program','event:end-of-game'].map(function(a){return'-progbot:'+a}).join());var e=d('progbot:init:debug');e('\t\t\t--==[ start ]==--\t\t\t')},function(a){function b(){throw new Error('setTimeout has not been defined')}function c(){throw new Error('clearTimeout has not been defined')}function d(a){if(j===setTimeout)return setTimeout(a,0);if((j===b||!j)&&setTimeout)return j=setTimeout,setTimeout(a,0);try{return j(a,0)}catch(b){try{return j.call(null,a,0)}catch(b){return j.call(this,a,0)}}}function e(a){if(k===clearTimeout)return clearTimeout(a);if((k===c||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(a);try{return k(a)}catch(b){try{return k.call(null,a)}catch(b){return k.call(this,a)}}}function f(){o&&m&&(o=!1,m.length?n=m.concat(n):p=-1,n.length&&g())}function g(){if(!o){var a=d(f);o=!0;for(var b=n.length;b;){for(m=n,n=[];++p<b;)m&&m[p].run();p=-1,b=n.length}m=null,o=!1,e(a)}}function h(a,b){this.fun=a,this.array=b}function i(){}var j,k,l=a.exports={};(function(){try{j='function'==typeof setTimeout?setTimeout:b}catch(a){j=b}try{k='function'==typeof clearTimeout?clearTimeout:c}catch(a){k=c}})();var m,n=[],o=!1,p=-1;l.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];n.push(new h(a,b)),1!==n.length||o||d(g)},h.prototype.run=function(){this.fun.apply(null,this.array)},l.title='browser',l.browser=!0,l.env={},l.argv=[],l.version='',l.versions={},l.on=i,l.addListener=i,l.once=i,l.off=i,l.removeListener=i,l.removeAllListeners=i,l.emit=i,l.prependListener=i,l.prependOnceListener=i,l.listeners=function(){return[]},l.binding=function(){throw new Error('process.binding is not supported')},l.cwd=function(){return'/'},l.chdir=function(){throw new Error('process.chdir is not supported')},l.umask=function(){return 0}},function(a,b,c){function d(a){var c,d=0;for(c in a)d=(d<<5)-d+a.charCodeAt(c),d|=0;return b.colors[Math.abs(d)%b.colors.length]}function e(a){function c(){if(c.enabled){var a=c,d=+new Date,f=d-(e||d);a.diff=f,a.prev=e,a.curr=d,e=d;for(var g=Array(arguments.length),h=0;h<g.length;h++)g[h]=arguments[h];g[0]=b.coerce(g[0]),'string'!=typeof g[0]&&g.unshift('%O');var i=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(c,d){if('%%'===c)return c;i++;var e=b.formatters[d];if('function'==typeof e){var f=g[i];c=e.call(a,f),g.splice(i,1),i--}return c}),b.formatArgs.call(a,g);var j=c.log||b.log||console.log.bind(console);j.apply(a,g)}}var e;return c.namespace=a,c.enabled=b.enabled(a),c.useColors=b.useColors(),c.color=d(a),c.destroy=f,'function'==typeof b.init&&b.init(c),b.instances.push(c),c}function f(){var a=b.instances.indexOf(this);return-1!==a&&(b.instances.splice(a,1),!0)}b=a.exports=e.debug=e['default']=e,b.coerce=function(a){return a instanceof Error?a.stack||a.message:a},b.disable=function(){b.enable('')},b.enable=function(a){b.save(a),b.names=[],b.skips=[];var c,d=('string'==typeof a?a:'').split(/[\s,]+/),e=d.length;for(c=0;c<e;c++)d[c]&&(a=d[c].replace(/\*/g,'.*?'),'-'===a[0]?b.skips.push(new RegExp('^'+a.substr(1)+'$')):b.names.push(new RegExp('^'+a+'$')));for(c=0;c<b.instances.length;c++){var f=b.instances[c];f.enabled=b.enabled(f.namespace)}},b.enabled=function(a){if('*'===a[a.length-1])return!0;var c,d;for(c=0,d=b.skips.length;c<d;c++)if(b.skips[c].test(a))return!1;for(c=0,d=b.names.length;c<d;c++)if(b.names[c].test(a))return!0;return!1},b.humanize=c(23),b.instances=[],b.names=[],b.skips=[],b.formatters={}},function(a){function b(a){if(a+='',!(100<a.length)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),e=(b[2]||'ms').toLowerCase();return'years'===e||'year'===e||'yrs'===e||'yr'===e||'y'===e?c*d:'days'===e||'day'===e||'d'===e?c*h:'hours'===e||'hour'===e||'hrs'===e||'hr'===e||'h'===e?c*k:'minutes'===e||'minute'===e||'mins'===e||'min'===e||'m'===e?c*j:'seconds'===e||'second'===e||'secs'===e||'sec'===e||'s'===e?c*i:'milliseconds'===e||'millisecond'===e||'msecs'===e||'msec'===e||'ms'===e?c:void 0}}}function c(a){return a>=h?g(a/h)+'d':a>=k?g(a/k)+'h':a>=j?g(a/j)+'m':a>=i?g(a/i)+'s':a+'ms'}function e(a){return f(a,h,'day')||f(a,k,'hour')||f(a,j,'minute')||f(a,i,'second')||a+' ms'}function f(a,b,c){return a<b?void 0:a<1.5*b?Math.floor(a/b)+' '+c:Math.ceil(a/b)+' '+c+'s'}var g=Math.round,i=1e3,j=60*i,k=60*j,h=24*k,d=365.25*h;a.exports=function(a,d){d=d||{};var f=typeof a;if('string'==f&&0<a.length)return b(a);if('number'==f&&!1===isNaN(a))return d.long?e(a):c(a);throw new Error('val is not a non-empty string or a valid number. val='+JSON.stringify(a))}},function(a,b,c){var d=c(1);a.exports=function(){var a=document.getElementById('c'),b=a.getContext('2d');d(a,b)}},function(a,b,c){var d=c(2);a.exports=function(a){d.loadBoard(a)}},function(a,b,c){var d=c(0)('progbot:game:board:get-board'),e=c(27);a.exports=function(a,b){var c=e(a,4,'0')+'.json';d('try to get the "%s" board',c);var f=new XMLHttpRequest;f.open('GET',c),f.onload=function(){var a=[],c=null;if(200==f.status)try{var d=JSON.parse(f.responseText);a=d}catch(a){c='json parse error in ajax request'}else c='ajax request failed. status code: '+f.status;b(c,a)},f.send()}},function(a){a.exports=function(a,b,c){var d=a+'',e=c+'',f=!!e.length,g=d.length<b;for(f||console.warn('pad inpossible because no pad character defined',arguments);g&&f;)d=e+d,g=d.length<b;return d}},function(a){var b=document.getElementById('demo-container'),c=33;a.exports=function(a,d){var e=document.createElement('img'),f=(Math.random()+'').replace('.',''),g='demo-image-'+f;e.setAttribute('id',g),e.onload=function(){function a(){b.classList.add('hide'),b.removeChild(e),b.removeChild(h),clearInterval(f),clearTimeout(j),d()}b.classList.remove('hide');var e=document.getElementById(g);e.setAttribute('style','margin-left:-'+e.width/2+'px;margin-top:-'+e.height/2+'px;'),h.setAttribute('style','margin-top:-'+Math.min(e.height/2+32,window.innerHeight/2-5)+'px;');var f=setInterval(function(){i--,h.innerHTML=i+''},999),j=setTimeout(function(){a()},1e3*c);document.addEventListener('keydown',function b(c){c.preventDefault(),document.removeEventListener('keydown',b),a()})},e.onerror=function(){d()},e.setAttribute('src',a),b.appendChild(e);var h=document.createElement('div');h.setAttribute('id','demo-timer-'+f);var i=c;h.innerHTML=i,b.appendChild(h)}},function(a,b,c){var d=c(30);a.exports=function(){window.addEventListener('resize',d),d()},a.exports.done=function(){window.removeEventListener('resize',d)}},function(a,b,c){var d=c(1),f=c(0)('progbot:event:resize'),g=c(4);a.exports=function(a){f(a?'resize event handling':'initial resize event'),d.setSize(window.innerWidth,window.innerHeight),g()}},function(a,b,c){var d=Math.PI,e=c(1),f=c(3),g=c(6),h=c(7),i=c(8),j=document.getElementById('box');a.exports=function(a,b){var c=e.ctx,k=g(a.x,a.y),l=k.x,m=k.y,n=f.boardItemSize-f.boardItemMargin,o=0.05*n,p=0.9*n,q=0.4*n,r=0.2*n,s=0.5*n;switch(c.fillRect(l-s,m-s,n,n),c.strokeRect(l-s,m-s,n,n),a.type){case h.X:c.save(),c.translate(l,m),c.rotate(3*Math.random()*d/180),c.drawImage(j,-s+o,-s+o,p,p),c.restore();break;case h.S:b||i({x:l,y:m,direction:0});break;case h.E:c.save(),c.translate(l,m),c.beginPath(),c.strokeStyle='#000',c.lineWidth=o,c.arc(0,0,q,0,2*d),c.stroke(),c.beginPath(),c.strokeStyle='#D00',c.fillStyle='#D00',c.arc(0,0,2*o,0,2*d),c.stroke(),c.fill(),c.beginPath(),c.lineWidth=1,c.strokeStyle='#000',c.moveTo(0,-q),c.lineTo(0,q),c.moveTo(-q,0),c.lineTo(q,0),c.moveTo(-r,-o),c.lineTo(-r,o),c.moveTo(r,-o),c.lineTo(r,o),c.lineWidth=0.5,c.moveTo(-o,r),c.lineTo(o,r),c.moveTo(-o,-r),c.lineTo(o,-r),c.stroke(),c.restore();}}},function(a,b,c){var d=c(1),e=c(3),f=c(0)('progbot:draw:draw-step'),g=c(33),h=c(34),i=e.programStepSize-e.programStepMargin;a.exports=function(a,b,c,j){f('now draw a step',a,b,c);var k=b*e.programStepSize,l=d.height-(a+1)*e.programStepSize;d.ctx.fillStyle=j?e.programStepHighlightBackground:e.programStepBackground,d.ctx.fillRect(k,l,i,i),d.ctx.strokeRect(k,l,i,i);'left'==c||'right'==c||'up'==c||'down'==c?g(k+i/2,l+i/2,c,i,j):'space'==c?h(k+i/2,l+i/2,i,j):console.warn('unknown program step',c)}},function(a,b,c){var d=Math.PI,e=c(1),f=c(3),g=c(0)('progbot:draw:arrow'),h={left:270*d/180,up:0*d/180,right:90*d/180,down:180*d/180},i=null;a.exports=function(a,b,c,d,j){var k=0.45*d,l=0.35*d,m=0.25*d,n=0.2*d,o=0.1*d,p=0.05*d,q=e.ctx;if(g('draw %s arrow',c),q.save(),q.translate(a,b),q.beginPath(),j){var r=q.createLinearGradient(0,k,0,-k);r.addColorStop(0,f.arrowHighlightGradiendStartColor),r.addColorStop(1,f.arrowHighlightGradiendEndColor),q.fillStyle=r}else i||(i=q.createLinearGradient(0,k,0,-k),i.addColorStop(0,f.arrowGradientStartColor),i.addColorStop(1,f.arrowGradientEndColor)),q.fillStyle=i;'up'==c||'down'==c?(q.rotate(h[c]),q.moveTo(0,-k),q.lineTo(k,0),q.lineTo(n,-p),q.lineTo(m,k),q.lineTo(-m,k),q.lineTo(-n,-p),q.lineTo(-k,0)):'right'==c?(q.moveTo(k,0),q.lineTo(p,-k),q.lineTo(o,-n),q.arcTo(-l,-n,-l,n,k),q.lineTo(-l,k),q.lineTo(0,k),q.arcTo(0,m,o,n,n),q.lineTo(p,k)):'left'==c?(q.moveTo(-k,0),q.lineTo(-p,-k),q.lineTo(-o,-n),q.arcTo(l,-n,l,n,k),q.lineTo(l,k),q.lineTo(0,k),q.arcTo(0,m,-o,n,n),q.lineTo(-p,k)):console.warn('invalid direction in arrow',c),q.closePath(),q.fill(),q.stroke(),q.restore()}},function(a,b,c){var d=c(1),e=c(3),f=c(0)('progbot:draw:wait'),g=null;a.exports=function(a,b,c,h){var i=0.42*c,j=i/2,k=j*1.7320508075688772,l=Math.floor(c/5),m=d.ctx;if(f('draw wait instruction'),m.save(),m.translate(a,b),m.beginPath(),h){var n=m.createLinearGradient(0,i,0,-i);n.addColorStop(0,e.waitHighlightGradiendStartColor),n.addColorStop(1,e.waitHighlightGradiendEndColor),m.fillStyle=n}else g||(g=m.createLinearGradient(0,i,0,-i),g.addColorStop(0,e.waitGradientStartColor),g.addColorStop(1,e.waitGradientEndColor)),m.fillStyle=g;m.moveTo(-j,-k),m.lineTo(j,-k),m.lineTo(i,0),m.lineTo(j,k),m.lineTo(-j,k),m.lineTo(-i,0),m.closePath(),m.fill(),m.stroke(),m.fillStyle=h?e.waitTextHighlightColor:e.waitTextColor,m.textBaseline='middle',m.textAlign='center',m.font='bold '+l+'pt Arial',m.fillText('STOP',0,0),m.restore()}},function(a,b,c){var d=c(36),e=c(38),f=c(15),g=c(49),h=c(50),i=c(51);a.exports=function(a){switch(a.preventDefault(),a.key){case'ArrowLeft':case'ArrowRight':case'ArrowUp':case'ArrowDown':h(a.key.replace('Arrow','').toLowerCase());break;case' ':i();break;case'Backspace':d();break;case'Enter':f();break;case'F':case'f':g();break;case'Escape':e();break;case'F5':location.reload();break;default:console.log('unhandled keyboard event',a);}}},function(a,b,c){var d=c(37),e=c(4),f=c(2);a.exports=function(){f()==f.IDLE?(d(),e()):console.warn('don\'t touch keyboard while animating...',f())}},function(a,b,c){var d=c(2);a.exports=function(){d.removeLastProgramStep()}},function(a,b,c){var d=c(0)('progbot:event:end-of-game'),e=c(39),f=c(15),g=c(2);a.exports=function(){var a=c(14);g()==g.RESULT_ANIMATION?(d('canceling the result screen'),f.cancelResult()):g()==g.IDLE?(d('end of the game'),g(g.END),a.done(),e()):console.warn('oh no, escape')}},function(a,b,c){var d=c(1),e=c(10);a.exports=function(){e();var a=d.ctx;a.textAlign='center',a.fillStyle='#e00',a.font='64px Arial',a.fillText('The End',d.centerX,d.centerY)}},function(a,b,c){var d=c(41),e=c(6),f=c(7),g=c(0)('progbot:event:on:end-of-programming:animate-program'),h=c(13),i=c(5),j=c(2),k=-1,l=null;a.exports=function a(b){var c=null,m=j.getProgram();if(0==m.length)return c=new Error('there is no program'),b(c,{x:0,y:0,direction:0});if(!l){g('there is no robot position, calculate it');var n=j.getBoard(),o=n.find((a)=>a.type==f.S);if(!o)return c=new Error('invalid board, no start position defined'),console.error(c),b(c,null);var p=e(o.x,o.y);l={x:p.x,y:p.y,direction:0}}k++;var q=m[k];h(m,k),d(l,q,function(c,d){d?b(null,c):setTimeout(function(){l=c,k<m.length-1?a(b):b(null,c)},1e3*i.waitForNextStepSeconds)})},a.exports.reset=function(){k=-1,l=null}},function(a,b,c){var d=c(42),e=c(43),f=c(0)('progbot:event:on:end-of-programming:animate-step'),g=c(8),h=c(44),i=c(5),j=c(45),k=c(9);a.exports=function(a,b,c){function l(){var e=1e3*i.robotStepTimeSeconds,f=Date.now(),j=Math.min(1,(f-o)/e),m=d(a,b,p?j:0.1*Math.random());k.restore(),g(m),1>j?setTimeout(l,1e3/25):p?null==n?h(m,function(){c(m,!0)}):c(m):(k.restore(),g(a),c(a))}var m=e(a,b),n=j(m),o=Date.now(),p=null==n||!0==n;f('need to move?',p),l()}},function(a,b,c){var d=c(3);a.exports=function(a,b,c){1<c&&(console.warn('percent is greater than one :(',c),c=1),0>c&&(console.warn('percent is lower than zero :(',c),c=0);var e=Object.assign({},a);switch(b){case'up':switch(a.direction){case 0:e.y-=d.boardItemSize*c;break;case 90:e.x+=d.boardItemSize*c;break;case 180:e.y+=d.boardItemSize*c;break;case 270:e.x-=d.boardItemSize*c;break;default:console.error('wrong direction detected',a);}break;case'down':switch(a.direction){case 0:e.y+=d.boardItemSize*c;break;case 90:e.x-=d.boardItemSize*c;break;case 180:e.y-=d.boardItemSize*c;break;case 270:e.x+=d.boardItemSize*c;break;default:console.error('wrong direction detected',a);}break;case'left':e.direction-=90*c;break;case'right':e.direction+=90*c;break;case'space':break;default:console.warn('unknown program instruction detected',b);}for(;360<=e.direction;)e.direction-=360;for(;0>e.direction;)e.direction+=360;return e}},function(a,b,c){var e=c(6),f=c(2);a.exports=function(a,b){var c=f.getBoard(),g=e.reverse(a.x,a.y),h=Object.assign({},g),i=0;if('up'==b?i=1:'down'==b&&(i=-1),i)switch(a.direction){case 0:h.y-=i;break;case 90:h.x+=i;break;case 180:h.y+=i;break;case 270:h.x-=i;}var d=c.find((a)=>a.x==h.x&&a.y==h.y);return d}},function(a,b,c){var d=c(0)('progbot:event:on:end-of-programming:fall-down'),e=c(8),f=c(5),g=c(9),h=1e3*f.robotStepTimeSeconds;a.exports=function(a,b){function c(){for(var f=Date.now(),i=Math.min(1,(f-d)/h),j=360*(Math.pow(i,3)*5)+a.direction;360<j;)j-=360;for(;0>j;)j+=360;var k=Object.assign({},a);k.direction=j,g.restore(),e(k,1-i),1>i?setTimeout(c,1e3/25):b()}var d=Date.now();c()}},function(a){a.exports=function(a){var b=null;return a&&(b=!(1&a.type)),b}},function(a,b,c){var d=c(6),e=c(7),f=c(2);a.exports=function(a){var b=!1;if(a){var c=d.reverse(a.x,a.y),g=f.getBoard(),h=g.find((a)=>a.type==e.E);h?b=h.x==c.x&&h.y==c.y:(console.error('there is no target tile in board'),b=!1)}return b}},function(a,b,c){var d=c(1),e=document.getElementById('smiley'),f=document.getElementById('sad');a.exports=function(a){var b=d.ctx,c=Math.min(d.centerX,d.centerY),g=0.05*c,h=0.9*c,i=0.5*c;b.save(),b.translate(d.centerX,d.centerY),b.rotate((45*Math.random()-22.5)*Math.PI/180),b.drawImage(a?e:f,-i+g,-i+g,h,h),b.restore()}},function(a,b,c){var d=Math.min,e=Math.max,f=c(1),g=c(3),h=c(0)('progbot:draw:util:extend-board');a.exports=function(a){var b=Object.assign({},a);return b.x=e(0,b.x-g.boardItemSize),b.y=e(0,b.y-g.boardItemSize),b.w=d(f.width,b.w+2*g.boardItemSize),b.h=d(f.height,b.h+2*g.boardItemSize),h('extend board from %o to %o',a,b),b}},function(a,b,c){var d=c(16);a.exports=d},function(a,b,c){var d=c(17),e=c(4),f=c(2);a.exports=function(a){f()==f.IDLE?(d(a),e()):console.warn('don\'t touch keyboard while animating!',f())}},function(a,b,c){var d=c(17),e=c(4),f=c(2);a.exports=function(){f()==f.IDLE?(d('space'),e()):console.warn('don\'t touch keyboard while animating!',f())}},function(a){a.exports=function(){}}]);